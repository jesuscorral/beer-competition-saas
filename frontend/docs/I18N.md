# Internationalization (i18n) Guide

## Overview

The Beer Competition SaaS Platform frontend uses **react-i18next** for internationalization, allowing the application to support multiple languages.

## Supported Languages

Currently supported languages:
- **English (en)** - Default language
- **Spanish (es)** - Espa√±ol

## Project Structure

```
frontend/src/
‚îú‚îÄ‚îÄ i18n.ts                          # i18n configuration
‚îú‚îÄ‚îÄ locales/
‚îÇ   ‚îú‚îÄ‚îÄ en/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ translation.json         # English translations
‚îÇ   ‚îî‚îÄ‚îÄ es/
‚îÇ       ‚îî‚îÄ‚îÄ translation.json         # Spanish translations
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ LanguageSelector.tsx         # Language switcher component
```

## How It Works

### Configuration

The i18n system is configured in [src/i18n.ts](../i18n.ts):
- Auto-detects user's preferred language from browser settings
- Falls back to English if detection fails
- Caches selected language in localStorage
- Debug mode enabled in development

### Translation Files

Translation keys are organized hierarchically in JSON files:

**Example structure:**
```json
{
  "common": {
    "loading": "Loading...",
    "error": "Error"
  },
  "navbar": {
    "title": "Beer Competition Platform",
    "createCompetition": "Create Competition"
  },
  "home": {
    "welcome": "Welcome to Beer Competition Platform"
  }
}
```

## Usage in Components

### Basic Translation

```tsx
import { useTranslation } from 'react-i18next';

export function MyComponent() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('home.welcome')}</h1>
      <p>{t('home.subtitle')}</p>
    </div>
  );
}
```

### Translation with Interpolation

For dynamic values, use double curly braces in translation files:

**translation.json:**
```json
{
  "competition": {
    "success": "Competition created successfully! ID: {{id}}"
  }
}
```

**Component:**
```tsx
const { t } = useTranslation();
toast.success(t('competition.create.success', { id: competitionId }));
```

### Changing Language

Users can switch languages using the `LanguageSelector` component in the navbar:

```tsx
import { LanguageSelector } from './components/LanguageSelector';

<LanguageSelector />
```

Or programmatically:
```tsx
const { i18n } = useTranslation();
i18n.changeLanguage('es'); // Switch to Spanish
```

## Adding New Languages

### Step 1: Create Translation File

Create a new directory under `src/locales/` with the language code:

```bash
mkdir src/locales/fr
```

Copy the English translation file as a template:
```bash
cp src/locales/en/translation.json src/locales/fr/translation.json
```

### Step 2: Translate Content

Edit `src/locales/fr/translation.json` and translate all values:

```json
{
  "navbar": {
    "title": "Plateforme de Comp√©tition de Bi√®re",
    "createCompetition": "Cr√©er une Comp√©tition"
  }
}
```

### Step 3: Register Language

Update [src/i18n.ts](../i18n.ts):

```typescript
import frTranslation from './locales/fr/translation.json';

const resources = {
  en: { translation: enTranslation },
  es: { translation: esTranslation },
  fr: { translation: frTranslation }, // Add new language
};
```

### Step 4: Add to Language Selector

Update [src/components/LanguageSelector.tsx](../components/LanguageSelector.tsx):

```typescript
const languages = [
  { code: 'en', label: 'English', flag: 'üá¨üáß' },
  { code: 'es', label: 'Espa√±ol', flag: 'üá™üá∏' },
  { code: 'fr', label: 'Fran√ßais', flag: 'üá´üá∑' }, // Add new language
];
```

## Adding New Translation Keys

When adding new UI text, follow these steps:

### Step 1: Add Key to ALL Language Files

Add the same key path to **every** translation file with appropriate translations:

**en/translation.json:**
```json
{
  "competition": {
    "list": {
      "title": "Competitions",
      "empty": "No competitions found"
    }
  }
}
```

**es/translation.json:**
```json
{
  "competition": {
    "list": {
      "title": "Competiciones",
      "empty": "No se encontraron competiciones"
    }
  }
}
```

### Step 2: Use in Component

```tsx
const { t } = useTranslation();

return (
  <div>
    <h1>{t('competition.list.title')}</h1>
    {competitions.length === 0 && (
      <p>{t('competition.list.empty')}</p>
    )}
  </div>
);
```

## Best Practices

### 1. Never Hardcode User-Facing Text

‚ùå **BAD:**
```tsx
<button>Create Competition</button>
```

‚úÖ **GOOD:**
```tsx
<button>{t('navbar.createCompetition')}</button>
```

### 2. Use Descriptive Key Names

‚ùå **BAD:**
```json
{
  "text1": "Welcome",
  "button2": "Submit"
}
```

‚úÖ **GOOD:**
```json
{
  "home": {
    "welcome": "Welcome",
    "submitButton": "Submit"
  }
}
```

### 3. Group Related Keys

Group translation keys by feature or component:

```json
{
  "competition": {
    "create": { ... },
    "edit": { ... },
    "list": { ... }
  },
  "judging": {
    "scoresheet": { ... },
    "flight": { ... }
  }
}
```

### 4. Handle Pluralization

For texts that change based on count, use i18next pluralization:

```json
{
  "entry": "{{count}} entry",
  "entry_plural": "{{count}} entries"
}
```

```tsx
t('entry', { count: 1 }) // "1 entry"
t('entry', { count: 5 }) // "5 entries"
```

### 5. Keep Translations In Sync

When adding a key to one language, **immediately** add it to all other languages to avoid missing translations.

## Development Workflow

### Testing Translations

1. **Check browser console**: Debug mode shows missing keys
2. **Test all languages**: Switch using the language selector
3. **Verify interpolations**: Test dynamic values
4. **Check responsive design**: Some languages (e.g., German) have longer words

### Missing Translation Keys

In development, missing keys show in the console:
```
i18next::translator: missingKey en translation home.newKey
```

The key name will be displayed in the UI until translated.

## Language Detection Priority

i18next checks languages in this order:
1. **localStorage** (`i18nextLng` key) - User's previous selection
2. **Browser navigator** - Browser's language settings
3. **Fallback** - English (en)

## Performance Considerations

- All translations are loaded at app startup
- Translations are cached in memory
- Language changes are instant (no reload needed)
- Bundle size impact: ~2-3KB per language

## Future Enhancements

Planned improvements:
- [ ] Add French (fr), German (de), Portuguese (pt)
- [ ] Implement lazy loading for translation files
- [ ] Add date/time localization (date-fns or Luxon)
- [ ] Number and currency formatting
- [ ] Right-to-left (RTL) language support
- [ ] Translation management platform integration

## Troubleshooting

### Translations Not Showing

1. Check if `./i18n` is imported in [src/main.tsx](../main.tsx)
2. Verify translation key exists in all language files
3. Check browser console for errors
4. Clear localStorage and refresh

### Language Not Switching

1. Check `localStorage.getItem('i18nextLng')`
2. Verify language code in `LanguageSelector`
3. Clear browser cache

### Missing Keys in Production

- Run TypeScript check: `npm run build`
- Use `i18next-parser` to extract keys automatically (future enhancement)

## Resources

- **react-i18next docs**: https://react.i18next.com/
- **i18next docs**: https://www.i18next.com/
- **Language codes (ISO 639-1)**: https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes

---

**Last Updated**: 2025-12-24  
**Related ADR**: (Future) ADR-008-frontend-internationalization.md
